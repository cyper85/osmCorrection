{"version":3,"file":"correctionTool.js","sourceRoot":"","sources":["correctionTool.ts"],"names":[],"mappings":"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","sourcesContent":["/* \n * The MIT License\n *\n * Copyright 2017 Andreas Neumann <andr.neumann@googlemail.com>.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\ndeclare var map: L.Map;\nimport { correctionObjectClass } from \"./correctionObject\";\nimport { osmObject,overpassObject,syntaxErrorObject } from \"./osmObjectInterface\";\n\ndeclare var auth: any;\n\nexport class correctionToolClass { \n    /**\n     * correctionObjects\n     * @type Array\n     */\n    callbacks: correctionObjectClass[];\n\n    registerObject(obj: correctionObjectClass):void {\n        this.callbacks.push(obj);\n        for(var tag in obj.downloadTags) {\n            this.overpassQuery(obj.downloadTags[tag]);\n        }\n    };\n\n    overpassQuery (option: string):void {\n        let bounds = map.getBounds().getSouth() + ',' + map.getBounds().getWest() + ',' + map.getBounds().getNorth() + ',' + map.getBounds().getEast();\n\n        $.getJSON(\"https://overpass-api.de/api/interpreter\",\n                {\"data\": '[out:json][timeout:25];(node[\"' + option + '\"](' + bounds + ');way[\"' + option + '\"](' + bounds + ');relation[\"' + option + '\"](' + bounds + '););out body;>;out skel qt;'},\n                this.correctData\n                );\n    };\n    \n    nodes: {[key: string]: osmObject};\n    ways: {[key: string]: osmObject};\n    relations: {[key: string]: osmObject};\n    syntaxErrors: syntaxErrorObject[];\n    syntaxFlag: boolean = true;\n\n    correctData (data: overpassObject):void {\n        for (let i = 0; i < data.elements.length; i++) {\n            if (data.elements[i].type === \"node\") {\n                if(typeof this.nodes[data.elements[i].id] !== \"undefined\") {\n                    continue;\n                }\n                this.nodes[data.elements[i].id] = data.elements[i];\n            } else if (data.elements[i].type === \"way\") {\n                if(typeof this.ways[data.elements[i].id] !== \"undefined\") {\n                    continue;\n                }\n                this.ways[data.elements[i].id] = data.elements[i];\n            } else if (data.elements[i].type === \"relation\") {\n                if(typeof this.relations[data.elements[i].id] !== \"undefined\") {\n                    continue;\n                }\n                this.relations[data.elements[i].id] = data.elements[i];\n            }\n            if (typeof data.elements[i].tags !== \"undefined\") {\n                let correct: string[] = [];\n                for(let key in this.callbacks) {\n                    correct = this.callbacks[key].correctingSyntax(data.elements[i]);\n                    if(correct.length>0) {\n                        for(var cKey in correct) {\n                            this.syntaxErrors.push({\n                                element: data.elements[i],\n                                tag: correct[cKey],\n                                plugin: this.callbacks[key]\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        if(this.syntaxFlag && (this.syntaxErrors.length>0)) {\n            this.syntaxFlag = false;\n            this.syntaxEditor();\n        }\n    }\n    \n    modifiedElements: any[];\n    syntaxError: syntaxErrorObject;\n    \n    syntaxEditor ():void {\n        this.syntaxError = this.syntaxErrors.shift();\n        this.showElement(this.syntaxError.element);\n        this.syntaxError.plugin.syntaxEditor(this.syntaxError.tag,this.syntaxError.element);\n    };\n    \n    \n    shownElement: L.FeatureGroup;\n    shownElementBounds: L.LatLngBounds;\n    \n    showNode(element: osmObject):void {\n        this.shownElement.addLayer(L.circle(L.latLng(element.lat, element.lon),3));\n        if(this.shownElementBounds === null) {\n            this.shownElementBounds = new L.LatLngBounds(L.latLng(element.lat, element.lon),L.latLng(element.lat, element.lon));\n        } else {\n            this.shownElementBounds = this.shownElementBounds.extend(L.latLng(element.lat, element.lon));\n        }\n    };\n    \n    showWay(element: osmObject):void {\n        let way = [];\n        let shownElement;\n        for(let i in element.nodes) {\n            way.push(L.latLng(this.nodes[element.nodes[i]].lat,this.nodes[element.nodes[i]].lon));\n        }\n        if(element.nodes[0] === element.nodes[element.nodes.length - 1]) {\n            shownElement = L.polygon(way);\n        } else {\n            shownElement = L.polyline(way);\n        }\n        \n        this.shownElement.addLayer(shownElement);\n        \n        if(this.shownElementBounds === null) {\n            this.shownElementBounds = shownElement.getBounds();\n        } else {\n            this.shownElementBounds.extend(shownElement.getBounds());\n        }\n    }\n    \n    showRelation (element:osmObject):void {\n        console.log(\"bah\");\n    }\n    \n    showElement(element: osmObject):void {\n        this.shownElementBounds = null;\n        map.removeLayer(this.shownElement);\n        this.shownElement.clearLayers();\n        \n        if(element.type === \"node\") {\n            this.showNode(element);\n        } else if (element.type === \"way\") {\n            this.showWay(element);\n        } else if (element.type === \"relation\") {\n            this.showRelation(element);\n        }\n        map.addLayer(this.shownElement);\n        \n        map.fitBounds(this.shownElementBounds);\n    };\n    \n    syntaxCorrection ():void {\n        \n        var input = $('input#input').val();\n        if(input !== this.syntaxError.element.tags[this.syntaxError.tag]) {\n            this.syntaxError.element.tags[this.syntaxError.tag] = input;\n            if(this.modifiedElements.indexOf(this.syntaxError.element) != -1) {\n                this.modifiedElements.splice(this.modifiedElements.indexOf(this.syntaxError.element),1);\n            }\n            this.modifiedElements.push(this.syntaxError.element);\n        }\n        // irgendwas speichern\n        if(this.syntaxErrors.length > 0) {\n            this.syntaxEditor();\n        } else {\n            $('#syntax').html(\"\");\n            document.getElementById(\"stateTwo\").classList.add(\"hidden\");\n            document.getElementById(\"stateThree\").classList.remove(\"hidden\");\n        }\n    }\n    \n    /**\n     * Erzeugt XML-Modifycode für Node\n     * @param {OSMElement} element\n     * @param int changesetID\n     * @returns {Element|correctionToolClass.saveNode.node}\n     */\n    saveNode(element:osmObject):Element {\n        var node = document.createElement('node');\n        \n        // ID\n        var id = document.createAttribute('id');\n        id.value = element.id;\n        node.setAttributeNode(id);\n        \n        // Changeset\n        var changeset = document.createAttribute('changeset');\n        changeset.value = this.changesetID;\n        node.setAttributeNode(changeset);\n        \n        // Version\n        var version = document.createAttribute('version');\n        version.value = String(element.version+1);\n        node.setAttributeNode(version);\n        \n        // Lat\n        var lat = document.createAttribute('lat');\n        lat.value = String(element.lat);\n        node.setAttributeNode(lat);\n        \n        // Lon\n        var lon = document.createAttribute('lon');\n        lon.value = String(element.lon);\n        node.setAttributeNode(lon);\n        \n        // Tags\n        for(var key in element.tags) {\n            var tag = document.createElement('tag');\n            \n            var k = document.createAttribute('k');\n            k.value = key;\n            tag.setAttributeNode(k);\n            \n            var v = document.createAttribute('v');\n            v.value = element.tags[key];\n            tag.setAttributeNode(v);\n            \n            node.appendChild(tag);\n        }\n        \n        return node;\n    } \n    \n    /**\n     * Erzeugt XML-Modifycode für Way\n     * @param {OSMElement} element\n     * @param int changesetID\n     * @returns {Element|correctionToolClass.saveNode.node}\n     */\n    saveWay(element:osmObject):Element {\n        var way = document.createElement('way');\n        \n        // ID\n        var id = document.createAttribute('id');\n        id.value = element.id;\n        way.setAttributeNode(id);\n        \n        // Changeset\n        var changeset = document.createAttribute('changeset');\n        changeset.value = this.changesetID;\n        way.setAttributeNode(changeset);\n        \n        // Version\n        var version = document.createAttribute('version');\n        version.value = String(element.version+1);\n        way.setAttributeNode(version);\n        \n        // Tags\n        for(var key in element.tags) {\n            var tag = document.createElement('tag');\n            \n            var k = document.createAttribute('k');\n            k.value = key;\n            tag.setAttributeNode(k);\n            \n            var v = document.createAttribute('v');\n            v.value = element.tags[key];\n            tag.setAttributeNode(v);\n            \n            way.appendChild(tag);\n        }\n        \n        // Nodes\n        for(var key in element.nodes) {\n            var nd = document.createElement('nd');\n            \n            var ref = document.createAttribute('ref');\n            ref.value = element.nodes[key];\n            nd.setAttributeNode(ref);\n            \n            way.appendChild(nd);\n        }\n        \n        return way;\n    };\n    \n    /**\n     * Erzeugt XML-Modifycode für Relation\n     * @param {OSMElement} element\n     * @param int changesetID\n     * @returns {Element|correctionToolClass.saveNode.node}\n     */\n    saveRelation(element:osmObject):Element {\n        var relation = document.createElement('relation');\n        \n        // ID\n        var id = document.createAttribute('id');\n        id.value = element.id;\n        relation.setAttributeNode(id);\n        \n        // Changeset\n        var changeset = document.createAttribute('changeset');\n        changeset.value = this.changesetID;\n        relation.setAttributeNode(changeset);\n        \n        // Version\n        var version = document.createAttribute('version');\n        version.value = String(element.version+1);\n        relation.setAttributeNode(version);\n        \n        // Tags\n        for(var key in element.tags) {\n            var tag = document.createElement('tag');\n            \n            var k = document.createAttribute('k');\n            k.value = key;\n            tag.setAttributeNode(k);\n            \n            var v = document.createAttribute('v');\n            v.value = element.tags[key];\n            tag.setAttributeNode(v);\n            \n            relation.appendChild(tag);\n        }\n        \n        // Members\n        for(var key in element.members) {\n            var member = document.createElement('member');\n            \n            var type = document.createAttribute('type');\n            type.value = element.members[key].type;\n            member.setAttributeNode(type);\n            \n            var role = document.createAttribute('role');\n            role.value = element.members[key].role;\n            member.setAttributeNode(role);\n            \n            var ref = document.createAttribute('ref');\n            ref.value = element.members[key].ref;\n            member.setAttributeNode(ref);\n            \n            relation.appendChild(member);\n        }\n        \n        return relation;\n    };\n    \n    \n    /**\n     * Öffne Changeset\n     */\n    openChangeset():void {\n        auth.xhr({\n            method: 'PUT',\n            path: '/api/0.6/changeset/create',\n            options: {header: {\"Content-Type\": \"text/xml\"}},\n            content: '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\n                    '<osm version=\"0.6\" generator=\"JOSM\">'+\n                    '<changeset>'+\n                        '<tag k=\"created_by\" v=\"osmCorrection v0.0.1\"/>'+\n                        '<tag k=\"comment\" v=\"Syntax correction and validation\"/>'+\n                    '</changeset>'+\n                '</osm>'\n        }, this.modifyChangeset);\n    };\n    \n    private changesetID: string;\n    modifyChangeset(err: any, data:string):void {\n        console.log(err);\n        console.log(data);\n        if ((!err) && data.length > 0) {\n            this.changesetID = data;\n        }\n        var osmChange = document.createElement('osmChange');\n            \n            //Version\n            var version = document.createAttribute('version');\n            version.value = '0.6';\n            osmChange.setAttributeNode(version);\n            \n            // Generator\n            var generator = document.createAttribute('generator');\n            generator.value = 'osmCorrectionTool';\n            osmChange.setAttributeNode(generator);\n            \n            var modify = document.createElement('modify');\n            \n            for(var i in this.modifiedElements) {\n                if(this.modifiedElements[i].type === \"node\") {\n                    modify.appendChild(this.saveNode(this.modifiedElements[i]));\n                } else if(this.modifiedElements[i].type === \"way\") {\n                    modify.appendChild(this.saveWay(this.modifiedElements[i]));\n                } else if(this.modifiedElements[i].type === \"relation\") {\n                    modify.appendChild(this.saveRelation(this.modifiedElements[i]));\n                }\n            }\n            \n            osmChange.appendChild(modify);\n        auth.xhr({\n            method: 'POST',\n            path: '/api/0.6/changeset/' + this.changesetID+'/upload',\n            options: {header: {\"Content-Type\": \"text/xml\"}},\n            content: '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\n            osmChange.outerHTML\n        }, this.closeChangeset);\n            \n            \n    }\n    \n    /**\n     * Schließe Changeset\n     */\n    closeChangeset():void {\n        auth.xhr({\n            method: 'PUT',\n            path: '/api/0.6/changeset/' + this.changesetID+'/close'\n        });\n    }\n    \n    /**\n     * Speichere Änderungen in OSM\n     * @returns {Boolean}\n     */\n    save():boolean {\n        if(this.modifiedElements.length>0) {\n            this.openChangeset();                \n        } else {\n            console.log(this.modifiedElements);\n        }\n        return false;\n    };\n};"]}